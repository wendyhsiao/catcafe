(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f4301fc0"],{"0d17":function(t,e,a){},"16b9":function(t,e,a){"use strict";var s=a("0d17"),i=a.n(s);i.a},"54db":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("AdminNavbar"),a("div",{staticClass:"conta iner py-5"},[t.isLoading?t._e():a("AdminCafeForm",{attrs:{"initial-cafe":t.cafe,"initial-images":t.images},on:{"after-submit":t.handleAfterSubmit}})],1)],1)},i=[],r=(a("96cf"),a("1da1")),n=a("be6c"),o=a("f92c"),c=a("de2e"),l=a("2fa3"),m={components:{AdminCafeForm:o["a"],AdminNavbar:c["a"]},data:function(){return{cafe:{id:-1,name:"",tel:"",address_city:"",address_dist:"",address_other:"",opening_hour:"",minimum_charge:"",facebook:"",instagram:"",consumption_patterns:"",rule:"",other:""},images:[],isLoading:!0}},created:function(){var t=this.$route.params.id;this.fetchCafe(t)},beforeRouteUpdate:function(t,e,a){var s=t.params.id;this.fetchCafe(s),a()},methods:{fetchCafe:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,n["a"].getAdminCafe(t);case 3:s=a.sent,i=s.data,e.cafe=i.cafe,e.images=i.cafe.Images,e.isLoading=!1,a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),console.log(a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},handleAfterSubmit:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,n["a"].putAdminCafe({cafeId:e.cafe.id,formData:t});case 3:if(s=a.sent,i=s.data,"success"===i.status){a.next=7;break}throw new Error(i.message);case 7:e.$router.push({name:"admin-cat-cafes"}),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](0),l["a"].fire({icon:"warning",title:a.t0}),console.log(a.t0);case 14:case"end":return a.stop()}}),a,null,[[0,10]])})))()}}},u=m,d=a("2877"),f=Object(d["a"])(u,s,i,!1,null,null,null);e["default"]=f.exports},a434:function(t,e,a){"use strict";var s=a("23e7"),i=a("23cb"),r=a("a691"),n=a("50c4"),o=a("7b0b"),c=a("65f0"),l=a("8418"),m=a("1dde"),u=a("ae40"),d=m("splice"),f=u("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,v=Math.min,g=9007199254740991,b="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!d||!f},{splice:function(t,e){var a,s,m,u,d,f,h=o(this),_=n(h.length),C=i(t,_),w=arguments.length;if(0===w?a=s=0:1===w?(a=0,s=_-C):(a=w-2,s=v(p(r(e),0),_-C)),_+a-s>g)throw TypeError(b);for(m=c(h,s),u=0;u<s;u++)d=C+u,d in h&&l(m,u,h[d]);if(m.length=s,a<s){for(u=C;u<_-s;u++)d=u+s,f=u+a,d in h?h[f]=h[d]:delete h[f];for(u=_;u>_-s+a;u--)delete h[u-1]}else if(a>s)for(u=_-s;u>C;u--)d=u+s-1,f=u+a-1,d in h?h[f]=h[d]:delete h[f];for(u=0;u<a;u++)h[u+C]=arguments[u+2];return h.length=_-s+a,m}})},dd51:function(t,e,a){},de2e:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar navbar-light bg-white"},[s("router-link",{staticClass:"navbar-brand",attrs:{to:{name:"admin-cat-cafes"}}},[s("img",{staticClass:"logo",attrs:{src:a("6b4d")}})]),t.isAuthenticated?s("div",[s("div",{staticClass:"mx-3 d-inline-block"},[t._v(" "+t._s(t.currentUser.name)+" ")]),s("div",{staticClass:"btn btn-yellow d-inline-block",on:{click:t.logout}},[t._v("登出 ")])]):t._e()],1)},i=[],r=a("5530"),n=a("2f62"),o={computed:Object(r["a"])({},Object(n["b"])(["currentUser","isAuthenticated"])),methods:{logout:function(){this.$store.commit("revokeAuthentication"),this.$router.push("/admin/catcafes/signin")}}},c=o,l=(a("16b9"),a("2877")),m=Object(l["a"])(c,s,i,!1,null,"5b7143eb",null);e["a"]=m.exports},e670:function(t,e,a){"use strict";var s=a("dd51"),i=a.n(s);i.a},f92c:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-white p-5"},[a("form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit(e)}}},[a("div",{staticClass:"form-group row"},[t._m(0),a("div",{staticClass:"col-sm-10"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.name,expression:"cafe.name"}],staticClass:"form-control",attrs:{name:"name",type:"text",id:"inputName"},domProps:{value:t.cafe.name},on:{input:function(e){e.target.composing||t.$set(t.cafe,"name",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputTel"}},[t._v("Tel")]),a("div",{staticClass:"col-sm-10"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.tel,expression:"cafe.tel"}],staticClass:"form-control",attrs:{name:"tel",type:"text",id:"inputTel"},domProps:{value:t.cafe.tel},on:{input:function(e){e.target.composing||t.$set(t.cafe,"tel",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[t._m(1),a("div",{staticClass:"col-sm-10"},[a("div",{staticClass:"form-row"},[a("div",{staticClass:"form-group col-md-3"},[a("label",{attrs:{for:"inputCity"}},[t._v("City")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.address_city,expression:"cafe.address_city"}],staticClass:"form-control",attrs:{name:"addressCity",type:"text",id:"inputCity"},domProps:{value:t.cafe.address_city},on:{input:function(e){e.target.composing||t.$set(t.cafe,"address_city",e.target.value)}}})]),a("div",{staticClass:"form-group col-md-3"},[a("label",{attrs:{for:"inputDistrict"}},[t._v("District")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.address_dist,expression:"cafe.address_dist"}],staticClass:"form-control",attrs:{name:"addressDist",type:"text",id:"inputDistrict"},domProps:{value:t.cafe.address_dist},on:{input:function(e){e.target.composing||t.$set(t.cafe,"address_dist",e.target.value)}}})]),a("div",{staticClass:"form-group col-md-6"},[a("label",{attrs:{for:"inputAddress"}},[t._v("Address")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.address_other,expression:"cafe.address_other"}],staticClass:"form-control",attrs:{name:"addressOther",type:"text",id:"inputAddress"},domProps:{value:t.cafe.address_other},on:{input:function(e){e.target.composing||t.$set(t.cafe,"address_other",e.target.value)}}})])])])]),a("div",{staticClass:"form-group row"},[t._m(2),a("div",{staticClass:"col-sm-10"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.opening_hour,expression:"cafe.opening_hour"}],staticClass:"form-control",attrs:{name:"openingHour",type:"text",id:"inputOpeningHour"},domProps:{value:t.cafe.opening_hour},on:{input:function(e){e.target.composing||t.$set(t.cafe,"opening_hour",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputMinimumCharge"}},[t._v("MinimumCharge")]),a("div",{staticClass:"col-sm-10"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.minimum_charge,expression:"cafe.minimum_charge"}],staticClass:"form-control",attrs:{name:"minimumCharge",type:"text",id:"inputMinimumCharge"},domProps:{value:t.cafe.minimum_charge},on:{input:function(e){e.target.composing||t.$set(t.cafe,"minimum_charge",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputFacebook"}},[t._v("Facebook")]),a("div",{staticClass:"col-sm-10"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.facebook,expression:"cafe.facebook"}],staticClass:"form-control",attrs:{name:"facebook",type:"text",id:"inputFacebook"},domProps:{value:t.cafe.facebook},on:{input:function(e){e.target.composing||t.$set(t.cafe,"facebook",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputInstagram"}},[t._v("Instagram")]),a("div",{staticClass:"col-sm-10"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cafe.instagram,expression:"cafe.instagram"}],staticClass:"form-control",attrs:{name:"instagram",type:"text",id:"inputInstagram"},domProps:{value:t.cafe.instagram},on:{input:function(e){e.target.composing||t.$set(t.cafe,"instagram",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputConsumptionPatterns"}},[t._v("ConsumptionPatterns")]),a("div",{staticClass:"col-sm-10"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.cafe.consumption_patterns,expression:"cafe.consumption_patterns"}],staticClass:"form-control",attrs:{name:"consumptionPatterns",cols:"30",rows:"5",id:"inputConsumptionPatterns"},domProps:{value:t.cafe.consumption_patterns},on:{input:function(e){e.target.composing||t.$set(t.cafe,"consumption_patterns",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputRule"}},[t._v("Rule")]),a("div",{staticClass:"col-sm-10"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.cafe.rule,expression:"cafe.rule"}],staticClass:"form-control",attrs:{name:"rule",cols:"30",rows:"5",id:"inputRule"},domProps:{value:t.cafe.rule},on:{input:function(e){e.target.composing||t.$set(t.cafe,"rule",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputOther"}},[t._v("Other")]),a("div",{staticClass:"col-sm-10"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.cafe.other,expression:"cafe.other"}],staticClass:"form-control",attrs:{name:"other",cols:"30",rows:"5",id:"inputOther"},domProps:{value:t.cafe.other},on:{input:function(e){e.target.composing||t.$set(t.cafe,"other",e.target.value)}}})])]),a("div",{staticClass:"form-group row"},[t._m(3),a("div",{staticClass:"col-sm-10"},[a("div",{staticClass:"row"},[t._l(t.images,(function(e){return a("div",{key:e.id,staticClass:"col-6 col-sm-3 mb-3"},[a("div",{staticClass:"image-group border rounded"},[a("img",{attrs:{src:e.url}}),a("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),t.deteleImage(e.id)}}},[t._v("Delete")]),a("input",{staticClass:"d-none",attrs:{type:"text",name:"imageId"},domProps:{value:e.id}})])])})),t._l(t.preview_list,(function(e,s){return a("div",{key:"a"+s,staticClass:"col-6 col-sm-3 mb-3"},[a("div",{staticClass:"image-group border rounded"},[a("img",{attrs:{src:e.imageURL}}),a("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.detelePreviewImage(s)}}},[t._v("Delete")])])])})),a("div",{staticClass:"col-6 col-sm-3 mb-3"},[a("div",{staticClass:"image-upload border rounded "},[t._m(4),a("input",{ref:"imageUploader",attrs:{id:"fileInput",type:"file",name:"image",accept:"image/*",multiple:"multiple"},on:{change:t.previewMultiImage}})])])],2)])]),a("div",{staticClass:"form-group row"},[a("div",{staticClass:"col-sm-12 text-right"},[a("router-link",{staticClass:"btn btn-secondary mr-3",attrs:{to:{name:"admin-cat-cafes"}}},[t._v("Cancel")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Submit")])],1)])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputName"}},[t._v("Name "),a("span",[t._v("*")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputCity"}},[t._v("Address "),a("span",[t._v("*")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputOpeningHour"}},[t._v("OpeningHour "),a("span",[t._v("*")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"Image"}},[t._v("Image "),a("span",[t._v("*")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"fileInput"}},[a("span",[t._v("+ Add Image")])])}],r=(a("4de4"),a("4160"),a("a434"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("2b3d"),a("5530")),n={props:{initialCafe:{type:Object,default:function(){return{id:-1,name:"",tel:"",address_city:"",address_dist:"",address_other:"",opening_hour:"",minimum_charge:"",facebook:"",instagram:"",consumption_patterns:"",rule:"",other:""}}},initialImages:{type:Array,required:!1}},data:function(){return{cafe:Object(r["a"])({},this.initialCafe),images:[],preview_list:[],image_list:[]}},watch:{initialCafe:function(t){this.cafe=Object(r["a"])(Object(r["a"])({},this.cafe),t)},initialImages:function(t){this.images=Object(r["a"])(Object(r["a"])({},this.images),t)}},created:function(){this.images=this.initialImages},methods:{previewMultiImage:function(t){var e=this,a=t.target.files,s=0;a&&a.forEach((function(t){e.preview_list.push({imageURL:window.URL.createObjectURL(t)}),e.image_list.push(a[s]),s++})),this.$refs.imageUploader.value=""},deteleImage:function(t){var e=this.images.filter((function(e){return e.id!==t}));this.images=e},detelePreviewImage:function(t){this.preview_list.splice(t,1),this.image_list.splice(t,1)},handleSubmit:function(t){var e=t.target,a=new FormData(e);a.set("image","");for(var s=0;s<this.image_list.length;s++)a.append("image",this.image_list[s]);this.$emit("after-submit",a)}}},o=n,c=(a("e670"),a("2877")),l=Object(c["a"])(o,s,i,!1,null,"7b7ede04",null);e["a"]=l.exports}}]);
//# sourceMappingURL=chunk-f4301fc0.cff527b0.js.map